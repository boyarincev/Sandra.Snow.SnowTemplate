---
layout: post
title: ASP.NET 5 и AngularJS Часть 1, Настраиваем проект: Grunt и AngularJS
categories: ASP-NET-5
published: draft
---

Это первая часть в серии постов по построению приложения на ASP.NET 5 (ASP.NET vNext) с использованием AngularJS. В этой серии постов, я покажу как создать простое веб-приложение целью которого является отслеживание ежедневного следования выбранных привычек, используя ASP.NET 5 и AngularJS.

Основной функционал приложения сводится к ежедневному контролю, следования выбранной привычке.

Вы можете скачать код обсуждаемый в этой статье из GitHub:

[https://github.com/boyarincev/GetHabitsAspNet5](https://github.com/boyarincev/GetHabitsAspNet5)

В этой статье я опишу, как подготовить Asp .Net 5 проект, в частности, как настроить Grunt на минификацию и объединение javascript файлов автоматически.

##Содаем Asp .Net 5 проект##

Мы будем использовать [Visual Studio 2015 Community Edition](https://www.visualstudio.com/downloads/download-visual-studio-vs) - она бесплатна для личного использования.

После того, как вы установите Visual Studio 2015, выберите File, New, Project, затем в разделе Templates, Visual C#, Web выберите ASP.NET Web Application и назовите новый проект "GetHabitsAspNet5"

![Создаем новый Asp.NET 5 проект](/images/asp-net-5/part1/create-new-project.jpg)

Выберите, Empty шаблон в разделе ASP.NET 5 Preview Templates

![Выбираем Empty Template](/images/asp-net-5/part1/choose-empty-template.jpg)

После того, как студия закончит генерацию шаблона, вы получите пустой ASP.NET 5 проект.

![Empty шаблон в Solution Explorer](/images/asp-net-5/part1/empty-project-sol-explorer.jpg)

Шаблон ASP.NET 5 значительно отличается от предыдущих версий. Теперь солюшен разделен на две папки, первая "Solution Items", вторая "src". Папка src содержит сам проект GetHabitsAspNet5.

GetHabitsAspNet5 проект содержит папку wwwroot. Назначение этой папки - хранить весь статический контент сайта: html, javascript, css файлы, картинки и другие ресурсы, доступ к которым осуществляется напрямую, а не через механизм роутинга ASP.NET. Доступ к статическому контенту за пределами этой папки теперь запрещен. Не следует хранить в ней файлы с исходным кодом, Less файлы, файлы javascript, которые еще планируется объединять и минифицировать. 

Давайте в корне проекта GetHabitsAspNet5 создадим папку Scripts - в ней мы будем хранить все javascript файлы.

![Создаем папку Scripts](/images/asp-net-5/part1/script-folder.jpg)

Вероятно раньше, для объединения и минификации javascript вы использовали механизм бандлов из ASP.NET MVC или использовали функции расширения WebEssentials, но теперь, с нативной поддержкой Grunt, мы можем всю подготовку фронтенда делать с помощью него.

##Используем NPM для получения необходимых пакетов##

Visual Studio 2015 нативно поддерживает три пакетных менеджера: NuGet, NPM и Bower.

Пакетные менеджеры позволяют легко устанавливать в ваш проект нужные вам ресурсы.

Предыдущие версии Visual Studio поддерживали только NuGet и он использовался как для установки бэкенд пакетов (различные .Net библиотеки), так и для фронтенда (JQuery, Boostrap и т.д.). Теперь NuGet будет использоваться только для .Net библиотек. Вы указываете какие NuGet пакеты вам нужны в проекте в файле project.json - этот файл, также содержит настройки проекта и заменяет файл web.config.

ASP.NET 5 также поддерживает NPM пакеты. NPM - пакетный менеджер созданный для управления пакетами NodeJS (альтернативный ASP.NET фреймворк для создания веб-приложений). Для управления пакетами NPM используется файл package.json.

И наконец, ASP.NET 5 поддерживает пакетный менеджер Bower. Bower - это пакетный менеджер созданный Twitter, для поддержки фронт-енд разработки, вы можете использовать его для управления клиентскими ресурсами, такими как AngularJS, JQuery, Bootstrap и т.д.

Для подготовки ресурсов к публикации на веб-сервер мы будем использовать [Grunt](http://gruntjs.com/). Grunt - это менеджер задач написанный на NodeJS, он имеет множество плагинов, которые упрощают пред-продакшен подготовку фронт-енд ресурсов. Для его установки и установки плагинов для него, мы будем использовать NPM.

Следуйте следующим шагам:

1. Клик правой кнопкой мыши по заголовку проекта GetHabitsAspNet5 и выбрать в контекстном меню Add, New Item.
2. Выберите NPM Configuration файл в DNX, Client-side.
3. Кликните кнопку Add.

![Файл конфигурации NPM](/images/asp-net-5/part1/npm-config-file.jpg)

Проделав эти шаги, вы добавите файл package.json в корень проекта GetHabitsAspNet5.

Вероятно он будет выглядеть вот так:

	{
		"version": "1.0.0",
		"name": "ASP.NET",
		"private": true,
		"devDependencies": {
		}
	} 

Для того, чтобы сказать NPM какие пакеты нам требуется установить, нужно добавить их в раздел devDependencies. Давайте добавим в него grunt и несколько плагинов к нему.

Исправьте ваш файл package.json, чтобы он выглядел вот так:

	{
	  "version": "1.0.0",
	  "name": "ASP.NET",
	  "private": true,
	  "devDependencies": {
	    "grunt": "~0.4.5",
	    "grunt-contrib-uglify": "~0.9.1",
	    "grunt-contrib-watch": "~0.6.1"
	  }
	}

Мы указали, что нам требуется три пакета: grunt, grunt-contrib-uglify, grunt-contrib-watch, после имени каждого пакета мы указали, версию пакета, которую будем использовать. Обратите внимание, что, как вы наберете название пакета и поставите двоеточие, студия будет подсказывать вам, возможные варианты для выбора версии пакета.

После того, как вы сохраните изменения в package.json в папке Dependencies появится новая под директория NPM и студия начнет загрузку выбранных пакетов (физически они будут находится в папке node-modules в корне проекта - но эта папка не отображается в Solution Explorer), которые можно будет увидеть, раскрыв папку NPM. Если загрузка не начнется, вы можете щелкнуть правой кнопкой мыши по ней и выбрать пункт "Restore Packages".

![Установленные NPM пакеты](/images/asp-net-5/part1/npm-packages.jpg)